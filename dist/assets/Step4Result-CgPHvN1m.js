import{u as x,b as E,r as p,a as e,j as a}from"./index-CH5urq1H.js";const M={0:"RWS_Tarot_00_Fool.jpg",1:"RWS_Tarot_01_Magician.jpg",2:"RWS_Tarot_02_High_Priestess.jpg",3:"RWS_Tarot_03_Empress.jpg",4:"RWS_Tarot_04_Emperor.jpg",5:"RWS_Tarot_05_Hierophant.jpg",6:"RWS_Tarot_06_Lovers.jpg",7:"RWS_Tarot_07_Chariot.jpg",8:"RWS_Tarot_08_Strength.jpg",9:"RWS_Tarot_09_Hermit.jpg",10:"RWS_Tarot_10_Wheel_of_Fortune.jpg",11:"RWS_Tarot_11_Justice.jpg",12:"RWS_Tarot_12_Hanged_Man.jpg",13:"RWS_Tarot_13_Death.jpg",14:"RWS_Tarot_14_Temperance.jpg",15:"RWS_Tarot_15_Devil.jpg",16:"RWS_Tarot_16_Tower.jpg",17:"RWS_Tarot_17_Star.jpg",18:"RWS_Tarot_18_Moon.jpg",19:"RWS_Tarot_19_Sun.jpg",20:"RWS_Tarot_20_Judgement.jpg",21:"RWS_Tarot_21_World.jpg"},D={22:"RWS_Tarot_AC.jpg",23:"RWS_Tarot_02C.jpg",24:"RWS_Tarot_03C.jpg",25:"RWS_Tarot_04C.jpg",26:"RWS_Tarot_05C.jpg",27:"RWS_Tarot_06C.jpg",28:"RWS_Tarot_07C.jpg",29:"RWS_Tarot_08C.jpg",30:"RWS_Tarot_09C.jpg",31:"RWS_Tarot_10C.jpg",32:"RWS_Tarot_PC.jpg",33:"RWS_Tarot_KC.jpg",34:"RWS_Tarot_QC.jpg",35:"RWS_Tarot_RC.jpg",36:"RWS_Tarot_AW.jpg",37:"RWS_Tarot_02W.jpg",38:"RWS_Tarot_03W.jpg",39:"RWS_Tarot_04W.jpg",40:"RWS_Tarot_05W.jpg",41:"RWS_Tarot_06W.jpg",42:"RWS_Tarot_07W.jpg",43:"RWS_Tarot_08W.jpg",44:"RWS_Tarot_09W.jpg",45:"RWS_Tarot_10W.jpg",46:"RWS_Tarot_PW.jpg",47:"RWS_Tarot_KW.jpg",48:"RWS_Tarot_QW.jpg",49:"RWS_Tarot_RW.jpg",50:"RWS_Tarot_AS.jpg",51:"RWS_Tarot_02S.jpg",52:"RWS_Tarot_03S.jpg",53:"RWS_Tarot_04S.jpg",54:"RWS_Tarot_05S.jpg",55:"RWS_Tarot_06S.jpg",56:"RWS_Tarot_07S.jpg",57:"RWS_Tarot_08S.jpg",58:"RWS_Tarot_09S.jpg",59:"RWS_Tarot_10S.jpg",60:"RWS_Tarot_PS.jpg",61:"RWS_Tarot_KS.jpg",62:"RWS_Tarot_QS.jpg",63:"RWS_Tarot_RS.jpg",64:"RWS_Tarot_AP.jpg",65:"RWS_Tarot_02P.jpg",66:"RWS_Tarot_03P.jpg",67:"RWS_Tarot_04P.jpg",68:"RWS_Tarot_05P.jpg",69:"RWS_Tarot_06P.jpg",70:"RWS_Tarot_07P.jpg",71:"RWS_Tarot_08P.jpg",72:"RWS_Tarot_09P.jpg",73:"RWS_Tarot_10P.jpg",74:"RWS_Tarot_PP.jpg",75:"RWS_Tarot_KP.jpg",76:"RWS_Tarot_QP.jpg",77:"RWS_Tarot_RP.jpg"};function R(s,r){let o;return s>=0&&s<=21?o=M[s]||`RWS_Tarot_${s.toString().padStart(2,"0")}_${r?.replace(/\s+/g,"_")||"Card"}.jpg`:s>=22&&s<=77?o=D[s]||`RWS_Tarot_${I(s,r)}`:o="RWS_Tarot_00_Fool.jpg",`https://upload.wikimedia.org/wikipedia/en/9/9b/${o}`}function I(s,r){if(r)return`${r.toLowerCase().replace(/\s+/g,"_")}.jpg`;const o=Math.floor((s-22)/14),l=(s-22)%14+1,d=["C","W","S","P"][o]||"C";if(l<=10)return`${l.toString().padStart(2,"0")}${d}.jpg`;{const _=["P","K","Q","R"],m=l-11;return`${_[m]}${d}.jpg`}}function F(){const{currentChain:s,question:r,generateAdvancedSuggestion:o,completeChain:l,prevStep:W,resetChain:d,goToStep:_,setQuestion:m}=x(),{saveRecord:k}=E(),[T,h]=p.useState(!1),[S,A]=p.useState(""),[i,v]=p.useState(null),[j,N]=p.useState(""),P=()=>{const t=o();A(t),h(!0)},w=()=>{console.log("å¼€å§‹è¿›é˜¶å åœ:",S),m(S),_(3),h(!1)},y=()=>{h(!1)},f=()=>{if(s&&s.layers.length>0){const t=s.layers[s.layers.length-1],c={id:`reading_${Date.now()}`,question:r||"æœªå¡«å†™é—®é¢˜",layoutId:t.divinationType,layoutName:t.divinationType,result:{layout:{id:t.divinationType,name:t.divinationType,description:t.divinationType,cardCount:t.cards.length,positions:t.cards.map(n=>n.position)},readings:t.cards.map((n,u)=>({position:n.position,positionIndex:u,card:{id:n.id||0,name_cn:n.name,name_en:n.nameEn||"",category:"major",number:0,image_url:R(n.id||0,n.nameEn||""),meaning_upright:n.meaning,meaning_reversed:n.meaning,keywords_upright:n.keywords,keywords_reversed:n.keywords,description:n.meaning,lucky_number:0,isReversed:n.isReversed,orientation:n.isReversed?"é€†ä½":"æ­£ä½",meaning:n.meaning,keywords:n.keywords},basicReading:{meaning:n.meaning,keywords:n.keywords,numerology:"0"},symbolism:n.meaning,personalInsight:n.meaning})),overallAnalysis:t.reading,timestamp:new Date().toISOString()},createdAt:new Date().toISOString()};k(c),N("âœ… ä¿å­˜æˆåŠŸï¼"),setTimeout(()=>N(""),2e3)}},$=()=>{d()},b=t=>{v(t)},C=()=>{v(null)};if(!s||s.layers.length===0)return e("div",{className:"step-content",children:a("div",{className:"error-message",children:[e("h3",{children:"å åœç»“æžœåŠ è½½å¤±è´¥"}),e("p",{children:"è¯·é‡æ–°è¿›è¡Œå åœ"}),e("button",{type:"button",className:"primary-button",onClick:W,children:"è¿”å›žä¸Šä¸€æ­¥"})]})});const g=s.layers[s.layers.length-1];return a("div",{className:"step-content",children:[a("div",{className:"step-header",children:[e("h2",{className:"step-title",children:"å åœç»“æžœ"}),a("p",{className:"step-subtitle",children:["å¡”ç½—ä¸ºä½ æŒ‡å¼•æ–¹å‘ Â· é—®é¢˜ï¼š",r]})]}),a("div",{className:"result-display",children:[a("div",{className:"result-header",children:[a("h3",{children:["ç¬¬ ",g.layerId," å±‚å åœ"]}),e("span",{className:"result-type",children:g.divinationType})]}),e("div",{className:"cards-result",children:g.cards.map((t,c)=>a("div",{className:"result-card enhanced",onClick:()=>b(t),children:[e("div",{className:"card-background",style:{backgroundImage:`url(${R(t.id||0,t.nameEn||"")})`,backgroundSize:"cover",backgroundPosition:"center",opacity:.25}}),e("div",{className:"card-overlay"}),a("div",{className:"card-content",children:[a("div",{className:"card-header",children:[a("h4",{className:"card-name",children:[t.name,a("span",{className:"card-name-en",children:["(",t.nameEn,")"]})]}),e("span",{className:`card-orientation ${t.isReversed?"reversed":"upright"}`,children:t.isReversed?"é€†ä½":"æ­£ä½"})]}),e("div",{className:"card-position",children:t.position}),e("div",{className:"card-meaning",children:t.meaning}),e("div",{className:"card-keywords",children:t.keywords.map((n,u)=>e("span",{className:"keyword",children:n},u))}),a("div",{className:"card-numerology",children:[e("span",{className:"numerology-label",children:"æ•°å­—å­¦ï¼š"}),e("span",{className:"numerology-value",children:t.nameEn.length%9||9})]}),e("button",{className:"detail-button",onClick:n=>{n.stopPropagation(),b(t)},children:"æŸ¥çœ‹å®Œæ•´è§£è¯»"})]})]},c))}),a("div",{className:"overall-reading",children:[e("h3",{children:"æ•´ä½“è§£è¯»"}),e("p",{children:g.reading})]})]}),!T&&s.layers.length===1&&a("div",{className:"advanced-suggestion",children:[e("h3",{children:"âœ¨ æˆ‘æœ‰ä¸ªæœ‰è¶£çš„å»ºè®®"}),e("p",{children:o()}),a("div",{className:"modal-actions",children:[e("button",{type:"button",className:"primary-button",onClick:P,children:"åŒæ„æ·±å…¥"}),e("button",{type:"button",className:"btn-ghost",onClick:y,children:"æš‚æ—¶ä¸äº†"})]})]}),T&&e("div",{className:"advanced-modal",children:a("div",{className:"modal-content",children:[e("h3",{children:"ðŸ’« è¿›é˜¶å»ºè®®"}),e("p",{className:"suggestion-text",children:S}),a("div",{className:"modal-actions",children:[e("button",{type:"button",className:"primary-button",onClick:w,children:"åŒæ„æ·±å…¥"}),e("button",{type:"button",className:"btn-ghost",onClick:y,children:"æš‚æ—¶ä¸äº†"})]})]})}),i&&e("div",{className:"card-detail-modal",onClick:C,children:a("div",{className:"modal-content",onClick:t=>t.stopPropagation(),children:[a("div",{className:"modal-header",children:[a("h3",{children:[i.name," (",i.nameEn,")"]}),e("button",{className:"close-button",onClick:C,children:"Ã—"})]}),a("div",{className:"modal-body",children:[e("div",{className:"detail-card-background",style:{backgroundImage:`url(${R(i.id||0,i.nameEn||"")})`,backgroundSize:"cover",backgroundPosition:"center",opacity:.15}}),e("div",{className:"detail-overlay"}),a("div",{className:"detail-content",children:[a("div",{className:"detail-section",children:[e("h4",{children:"åŸºæœ¬ä¿¡æ¯"}),a("div",{className:"detail-grid",children:[a("div",{className:"detail-item",children:[e("span",{className:"label",children:"ä½ç½®ï¼š"}),e("span",{className:"value",children:i.position})]}),a("div",{className:"detail-item",children:[e("span",{className:"label",children:"çŠ¶æ€ï¼š"}),e("span",{className:`value orientation ${i.isReversed?"reversed":"upright"}`,children:i.isReversed?"é€†ä½":"æ­£ä½"})]}),a("div",{className:"detail-item",children:[e("span",{className:"label",children:"æ•°å­—å­¦ï¼š"}),e("span",{className:"value",children:i.nameEn.length%9||9})]})]})]}),a("div",{className:"detail-section",children:[e("h4",{children:"å¿«é€Ÿè§£è¯»"}),e("p",{className:"quick-meaning",children:i.meaning})]}),a("div",{className:"detail-section",children:[e("h4",{children:"å…³é”®è¯"}),e("div",{className:"keywords-list",children:i.keywords.map((t,c)=>e("span",{className:"keyword",children:t},c))})]}),a("div",{className:"detail-section",children:[e("h4",{children:"å®Œæ•´è§£è¯»"}),a("p",{className:"full-meaning",children:["è¿™æ˜¯",i.name,"çš„å®Œæ•´è§£è¯»å†…å®¹...",i.isReversed?"é€†ä½ä»£è¡¨ç€æŒ‘æˆ˜ã€é˜»ç¢æˆ–å†…åœ¨å†²çªï¼Œéœ€è¦ä½ ç‰¹åˆ«å…³æ³¨è¿™ä¸ªæ–¹é¢çš„æˆé•¿ã€‚":"æ­£ä½ä»£è¡¨ç€é¡ºåˆ©ã€å’Œè°æˆ–å¤–åœ¨æœºé‡ï¼Œæ˜¯ä½ å½“å‰å¯ä»¥ç§¯æžåˆ©ç”¨çš„èƒ½é‡ã€‚"]})]})]})]})]})}),j&&e("div",{className:"save-message",style:{textAlign:"center",padding:"1rem",marginBottom:"1rem",background:"rgba(107, 142, 127, 0.2)",border:"1px solid rgba(107, 142, 127, 0.4)",borderRadius:"8px",color:"var(--upright)",fontFamily:"var(--font-body)",fontSize:"1rem"},children:j}),a("div",{className:"step-actions",children:[e("button",{type:"button",className:"btn-ghost",onClick:$,children:"é‡æ–°å åœ"}),e("button",{type:"button",className:"btn-ghost",onClick:f,children:"ðŸ’¾ ä¿å­˜ç»“æžœ"}),e("button",{type:"button",className:"primary-button",onClick:()=>console.log("åˆ†äº«åŠŸèƒ½"),children:"ðŸ“¤ åˆ†äº«ç»“æžœ"})]})]})}export{F as default};
